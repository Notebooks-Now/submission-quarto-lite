<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.257">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Steve Purves">
    <meta name="author" content="Rowan Cockett">
    <meta name="dcterms.date" content="2022-05-11">
    <meta name="keywords" content="La Palma, Earthquakes">

    <title>La Palma Earthquakes</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      if (offsetEl === null) {
        const contentEl = window.document.getElementById('quarto-content');
        for (const child of contentEl.children) {
          child.style.paddingTop = header.clientHeight + "px";
          child.style.marginTop = "1em";
        }
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      <meta name="citation_title" content="La Palma Earthquakes">
<meta name="citation_abstract" content="In September 2021, a significant jump in seismic activity on the island of La Palma (Canary Islands, Spain) signaled the start of a volcanic crisis that still continues at the time of writing. Earthquake data is continually collected and published by the Instituto Geográphico Nacional (IGN). We have created an accessible dataset from this and completed preliminary data analysis which shows seismicity originating at two distinct depths, consistent with the model of a two reservoir system feeding the currently very active volcano.
">
<meta name="citation_keywords" content="La Palma,Earthquakes">
<meta name="citation_author" content="Steve Purves">
<meta name="citation_author" content="Rowan Cockett">
<meta name="citation_publication_date" content="2022-05-11">
<meta name="citation_cover_date" content="2022-05-11">
<meta name="citation_year" content="2022">
<meta name="citation_online_date" content="2022-05-11">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Notebooks Now!">
<meta name="citation_reference" content="citation_title=Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands);,citation_author=José Marrero;,citation_author=Alicia García;,citation_author=Manuel Berrocoso;,citation_author=Ángeles Llinares;,citation_author=Antonio Rodríguez-Losada;,citation_author=R. Ortiz;,citation_publication_date=2019-07;,citation_cover_date=2019-07;,citation_year=2019;,citation_doi=10.1186/s13617-019-0085-5;,citation_volume=8;,citation_journal_title=Journal of Applied Volcanology;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      <a onclick="history.back(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./article.ipynb" class="btn btn-primary quarto-download-embed" download="article.ipynb">Download Notebook</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">La Palma Earthquakes</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Steve Purves <a href="mailto:steve@curvenote.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-0760-5497" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Curvenote
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Rowan Cockett <a href="https://orcid.org/0000-0002-7859-8394" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Curvenote
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">May 11, 2022</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>In September 2021, a significant jump in seismic activity on the island of La Palma (Canary Islands, Spain) signaled the start of a volcanic crisis that still continues at the time of writing. Earthquake data is continually collected and published by the Instituto Geográphico Nacional (IGN). We have created an accessible dataset from this and completed preliminary data analysis which shows seismicity originating at two distinct depths, consistent with the model of a two reservoir system feeding the currently very active volcano.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>La Palma, Earthquakes</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#eruption-history" id="toc-eruption-history" class="nav-link" data-scroll-target="#eruption-history">Eruption History</a></li>
  <li><a href="#magma-reservoirs" id="toc-magma-reservoirs" class="nav-link" data-scroll-target="#magma-reservoirs">Magma Reservoirs</a></li>
  </ul></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#main-timeline-figure" id="toc-main-timeline-figure" class="nav-link" data-scroll-target="#main-timeline-figure">Main Timeline Figure</a></li>
  <li><a href="#visualising-long-term-earthquake-data" id="toc-visualising-long-term-earthquake-data" class="nav-link" data-scroll-target="#visualising-long-term-earthquake-data">Visualising Long term earthquake data</a></li>
  <li><a href="#cumulative-distribution-plots" id="toc-cumulative-distribution-plots" class="nav-link" data-scroll-target="#cumulative-distribution-plots">Cumulative Distribution Plots</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#availability" id="toc-availability" class="nav-link" data-scroll-target="#availability">Availability</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div id="8b06862f" class="cell markdown">
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>La Palma is one of the west most islands in the Volcanic Archipelago of the Canary Islands, a Spanish territory situated is the Atlantic Ocean where at their closest point are 100km from the African coast <a href="#fig-map" class="quarto-xref">Figure&nbsp;1</a>. The island is one of the youngest, remains active and is still in the island forming stage.</p>
<div id="fig-map" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/la-palma-map.png" class="img-fluid figure-img" style="width:100.0%" data-align="center"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Map of La Palma in the Canary Islands. Image credit <a href="https://commons.wikimedia.org/w/index.php?curid=76638603">NordNordWest</a></figcaption>
</figure>
</div>
<p>La Palma has been constructed by various phases of volcanism, the most recent and currently active being the <em>Cumbre Vieja</em> volcano, a north-south volcanic ridge that constitutes the southern half of the island.</p>
<section id="eruption-history" class="level3">
<h3 class="anchored" data-anchor-id="eruption-history">Eruption History</h3>
<p>A number of eruptions were recorded since the colonization of the islands by Europeans in the late 1400s, these are summarised in <a href="#tbl-history" class="quarto-xref">Table&nbsp;1</a>.</p>
<div id="tbl-history" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;1: Recent historic eruptions on La Palma</caption>
<thead>
<tr class="header">
<th>Name</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Current</td>
<td>2021</td>
</tr>
<tr class="even">
<td>Teneguía</td>
<td>1971</td>
</tr>
<tr class="odd">
<td>Nambroque</td>
<td>1949</td>
</tr>
<tr class="even">
<td>El Charco</td>
<td>1712</td>
</tr>
<tr class="odd">
<td>Volcán San Antonio</td>
<td>1677</td>
</tr>
<tr class="even">
<td>Volcán San Martin</td>
<td>1646</td>
</tr>
<tr class="odd">
<td>Tajuya near El Paso</td>
<td>1585</td>
</tr>
<tr class="even">
<td>Montaña Quemada</td>
<td>1492</td>
</tr>
</tbody>
</table>
</div>
<p>This equates to an eruption on average every 79 years up until the 1971 event. The probability of a future eruption can be modeled by a Poisson distribution <a href="#eq-poisson" class="quarto-xref">Equation&nbsp;1</a>.</p>
<p><span id="eq-poisson"><span class="math display">\[
p(x)=\frac{e^{-\lambda} \lambda^{x}}{x !}
\tag{1}\]</span></span></p>
<p>Where <span class="math inline">\(\lambda\)</span> is the number of eruptions per year, <span class="math inline">\(\lambda=\frac{1}{79}\)</span> in this case. The probability of a future eruption in the next <span class="math inline">\(t\)</span> years can be calculated by:</p>
<p><span id="eq-probability"><span class="math display">\[
p_e = 1-\mathrm{e}^{-t \lambda}
\tag{2}\]</span></span></p>
<p>So following the 1971 eruption the probability of an eruption in the following 50 years — the period ending this year — was 0.469. After the event, the number of eruptions per year moves to <span class="math inline">\(\lambda=\frac{1}{75}\)</span> and the probability of a further eruption within the next 50 years (2022-2071) rises to 0.487 and in the next 100 years, this rises again to 0.736.</p>
</section>
<section id="magma-reservoirs" class="level3">
<h3 class="anchored" data-anchor-id="magma-reservoirs">Magma Reservoirs</h3>
<p>Studies of the magma systems feeding the volcano, such as <span class="citation" data-cites="marrero2019">Marrero et al. (<a href="#ref-marrero2019" role="doc-biblioref">2019</a>)</span> has proposed that there are two main magma reservoirs feeding the Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
<div id="fig-reservoirs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/reservoirs.png" class="img-fluid figure-img" style="width:100.0%" data-align="center"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Proposed model from Marrero et al</figcaption>
</figure>
</div>
<p>In this paper, we look at recent seismicity data to see if we can see evidence of such a system action, see <a href="#fig-reservoirs" class="quarto-xref">Figure&nbsp;2</a>.</p>
</section>
</section>
</div>
<div id="1c7a031d" class="cell markdown">
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>The earthquake dataset used in our analysis was generated from the <a href="https://www.ign.es/web/resources/volcanologia/tproximos/canarias.html">IGN web portal</a> this is public data released under a permissive license. Data recorded using the network of Seismic Monitoring Stations on the island. A web scraping script was developed to pull data into a machine-readable form for analysis. That code tool <a href="https://github.com/stevejpurves/ign-earthquake-data">is available on GitHub</a> along with a copy of recently updated data.</p>
</section>
</div>
<div id="63a26a1c" class="cell markdown">
<section id="main-timeline-figure" class="level2">
<h2 class="anchored" data-anchor-id="main-timeline-figure">Main Timeline Figure</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div id="184d6123" class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="76706a81" class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_category_columns(df):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Depth'</span>] <span class="op">=</span> <span class="st">'Shallow (&lt;18km)'</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    df.loc[(df[<span class="st">'Depth(km)'</span>] <span class="op">&gt;=</span> <span class="dv">18</span>) <span class="op">&amp;</span> (df[<span class="st">'Depth(km)'</span>] <span class="op">&lt;=</span> <span class="dv">28</span>), <span class="st">'Depth'</span>] <span class="op">=</span> <span class="st">'Interchange (18km&gt;x&gt;28km)'</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">'Depth(km)'</span>] <span class="op">&gt;=</span> <span class="dv">28</span>, <span class="st">'Depth'</span>] <span class="op">=</span> <span class="st">'Deep (&gt;28km)'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Mag'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    df.loc[(df[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="op">&amp;</span> (df[<span class="st">'Magnitude'</span>] <span class="op">&lt;=</span> <span class="dv">2</span>), <span class="st">'Mag'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    df.loc[(df[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="dv">2</span>) <span class="op">&amp;</span> (df[<span class="st">'Magnitude'</span>] <span class="op">&lt;=</span> <span class="dv">3</span>), <span class="st">'Mag'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    df.loc[(df[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="dv">3</span>) <span class="op">&amp;</span> (df[<span class="st">'Magnitude'</span>] <span class="op">&lt;=</span> <span class="dv">4</span>), <span class="st">'Mag'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    df.loc[(df[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="dv">4</span>) <span class="op">&amp;</span> (df[<span class="st">'Magnitude'</span>] <span class="op">&lt;=</span> <span class="dv">5</span>), <span class="st">'Mag'</span>] <span class="op">=</span> <span class="dv">4</span>    </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="3de56b46" class="cell markdown">
<section id="visualising-long-term-earthquake-data" class="level2">
<h2 class="anchored" data-anchor-id="visualising-long-term-earthquake-data">Visualising Long term earthquake data</h2>
<p>Data taken directly from the IGN Catalog</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="d4f84df5" class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_ign <span class="op">=</span> pd.read_csv(<span class="st">'./data/lapalma_ign.csv'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_ign <span class="op">=</span> make_category_columns(df_ign)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_ign.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Event</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Time</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Depth(km)</th>
<th data-quarto-table-cell-role="th">Intensity</th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Type Mag</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">DateTime</th>
<th data-quarto-table-cell-role="th">Timestamp</th>
<th data-quarto-table-cell-role="th">Swarm</th>
<th data-quarto-table-cell-role="th">Phase</th>
<th data-quarto-table-cell-role="th">Depth</th>
<th data-quarto-table-cell-role="th">Mag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>es2017eugju</td>
<td>2017-03-09</td>
<td>23:44:06</td>
<td>28.5346</td>
<td>-17.8349</td>
<td>26.0</td>
<td></td>
<td>1.6</td>
<td>4</td>
<td>NE FUENCALIENTE DE LA PALMA.IL</td>
<td>2017-03-09 23:44:06</td>
<td>1489103046000000000</td>
<td>0.0</td>
<td>0</td>
<td>Interchange (18km&gt;x&gt;28km)</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>es2017euhlh</td>
<td>2017-03-10</td>
<td>00:16:10</td>
<td>28.5491</td>
<td>-17.8459</td>
<td>27.0</td>
<td></td>
<td>2.0</td>
<td>4</td>
<td>N FUENCALIENTE DE LA PALMA.ILP</td>
<td>2017-03-10 00:16:10</td>
<td>1489104970000000000</td>
<td>0.0</td>
<td>0</td>
<td>Interchange (18km&gt;x&gt;28km)</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>es2017cpaoh</td>
<td>2017-03-10</td>
<td>00:16:11</td>
<td>28.5008</td>
<td>-17.8863</td>
<td>20.0</td>
<td></td>
<td>2.1</td>
<td>4</td>
<td>W LOS CANARIOS.ILP</td>
<td>2017-03-10 00:16:11</td>
<td>1489104971000000000</td>
<td>0.0</td>
<td>0</td>
<td>Interchange (18km&gt;x&gt;28km)</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>es2017eunnk</td>
<td>2017-03-10</td>
<td>03:20:26</td>
<td>28.5204</td>
<td>-17.8657</td>
<td>30.0</td>
<td></td>
<td>1.6</td>
<td>4</td>
<td>NW FUENCALIENTE DE LA PALMA.IL</td>
<td>2017-03-10 03:20:26</td>
<td>1489116026000000000</td>
<td>0.0</td>
<td>0</td>
<td>Deep (&gt;28km)</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>es2017kajei</td>
<td>2017-08-21</td>
<td>02:06:55</td>
<td>28.5985</td>
<td>-17.7156</td>
<td>0.0</td>
<td></td>
<td>1.6</td>
<td>4</td>
<td>E EL PUEBLO.ILP</td>
<td>2017-08-21 02:06:55</td>
<td>1503281215000000000</td>
<td>0.0</td>
<td>0</td>
<td>Shallow (&lt;18km)</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="41ccbc48" class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_ign[<span class="st">'DateTime'</span>] <span class="op">=</span> pd.to_datetime(df_ign[<span class="st">'Date'</span>] <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> df_ign[<span class="st">'Time'</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_ign[<span class="st">'DateTime'</span>]<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div id="a3816f99" class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_ign_early <span class="op">=</span> df_ign[df_ign[<span class="st">'DateTime'</span>] <span class="op">&lt;</span> <span class="st">'2021-09-11'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_ign_pre <span class="op">=</span> df_ign[(df_ign[<span class="st">'DateTime'</span>] <span class="op">&gt;=</span> <span class="st">'2021-09-11'</span>)<span class="op">&amp;</span>(df_ign[<span class="st">'DateTime'</span>] <span class="op">&lt;</span> <span class="st">'2021-09-19 14:13:00'</span>)]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_ign_phase1 <span class="op">=</span> df_ign[(df_ign[<span class="st">'DateTime'</span>] <span class="op">&gt;=</span> <span class="st">'2021-09-19 14:13:00'</span>)<span class="op">&amp;</span>(df_ign[<span class="st">'DateTime'</span>] <span class="op">&lt;</span> <span class="st">'2021-10-01'</span>)]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_ign_phase2 <span class="op">=</span> df_ign[(df_ign[<span class="st">'DateTime'</span>] <span class="op">&gt;=</span> <span class="st">'2021-10-01'</span>)<span class="op">&amp;</span>(df_ign[<span class="st">'DateTime'</span>] <span class="op">&lt;</span> <span class="st">'2021-12-01'</span>)]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df_ign_phase3 <span class="op">=</span> df_ign[(df_ign[<span class="st">'DateTime'</span>] <span class="op">&gt;=</span> <span class="st">'2021-12-01'</span>)<span class="op">&amp;</span>(df_ign[<span class="st">'DateTime'</span>] <span class="op">&lt;=</span> <span class="st">'2021-12-31'</span>)]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>df_erupt <span class="op">=</span> df_ign[(df_ign[<span class="st">'Date'</span>] <span class="op">&lt;</span> <span class="st">'2022-01-01'</span>) <span class="op">&amp;</span> (df_ign[<span class="st">'Date'</span>] <span class="op">&gt;</span> <span class="st">'2021-09-11'</span>)]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df_erupt_1 <span class="op">=</span> df_erupt[df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&lt;</span> <span class="fl">1.0</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df_erupt_2 <span class="op">=</span> df_erupt[(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="fl">1.0</span>)<span class="op">&amp;</span>(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&lt;</span> <span class="fl">2.0</span>)]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df_erupt_3 <span class="op">=</span> df_erupt[(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="fl">2.0</span>)<span class="op">&amp;</span>(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&lt;</span> <span class="fl">3.0</span>)]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_erupt_4 <span class="op">=</span> df_erupt[(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&gt;=</span> <span class="fl">3.0</span>)<span class="op">&amp;</span>(df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&lt;</span> <span class="fl">4.0</span>)]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df_erupt_5 <span class="op">=</span> df_erupt[df_erupt[<span class="st">'Magnitude'</span>] <span class="op">&gt;</span> <span class="fl">4.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="9bd70552" class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tab20_colors <span class="op">=</span> (</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.12156862745098039</span>, <span class="fl">0.4666666666666667</span>,  <span class="fl">0.7058823529411765</span>  ),  <span class="co"># 1f77b4</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.6823529411764706</span>,  <span class="fl">0.7803921568627451</span>,  <span class="fl">0.9098039215686274</span>  ),  <span class="co"># aec7e8</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>,                 <span class="fl">0.4980392156862745</span>,  <span class="fl">0.054901960784313725</span>),  <span class="co"># ff7f0e</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>,                 <span class="fl">0.7333333333333333</span>,  <span class="fl">0.47058823529411764</span> ),  <span class="co"># ffbb78</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.17254901960784313</span>, <span class="fl">0.6274509803921569</span>,  <span class="fl">0.17254901960784313</span> ),  <span class="co"># 2ca02c</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.596078431372549</span>,   <span class="fl">0.8745098039215686</span>,  <span class="fl">0.5411764705882353</span>  ),  <span class="co"># 98df8a</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.8392156862745098</span>,  <span class="fl">0.15294117647058825</span>, <span class="fl">0.1568627450980392</span>  ),  <span class="co"># d62728</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>,                 <span class="fl">0.596078431372549</span>,   <span class="fl">0.5882352941176471</span>  ),  <span class="co"># ff9896</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.5803921568627451</span>,  <span class="fl">0.403921568627451</span>,   <span class="fl">0.7411764705882353</span>  ),  <span class="co"># 9467bd</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.7725490196078432</span>,  <span class="fl">0.6901960784313725</span>,  <span class="fl">0.8352941176470589</span>  ),  <span class="co"># c5b0d5</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.5490196078431373</span>,  <span class="fl">0.33725490196078434</span>, <span class="fl">0.29411764705882354</span> ),  <span class="co"># 8c564b</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.7686274509803922</span>,  <span class="fl">0.611764705882353</span>,   <span class="fl">0.5803921568627451</span>  ),  <span class="co"># c49c94</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.8901960784313725</span>,  <span class="fl">0.4666666666666667</span>,  <span class="fl">0.7607843137254902</span>  ),  <span class="co"># e377c2</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.9686274509803922</span>,  <span class="fl">0.7137254901960784</span>,  <span class="fl">0.8235294117647058</span>  ),  <span class="co"># f7b6d2</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.4980392156862745</span>,  <span class="fl">0.4980392156862745</span>,  <span class="fl">0.4980392156862745</span>  ),  <span class="co"># 7f7f7f</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.7803921568627451</span>,  <span class="fl">0.7803921568627451</span>,  <span class="fl">0.7803921568627451</span>  ),  <span class="co"># c7c7c7</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.7372549019607844</span>,  <span class="fl">0.7411764705882353</span>,  <span class="fl">0.13333333333333333</span> ),  <span class="co"># bcbd22</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.8588235294117647</span>,  <span class="fl">0.8588235294117647</span>,  <span class="fl">0.5529411764705883</span>  ),  <span class="co"># dbdb8d</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.09019607843137255</span>, <span class="fl">0.7450980392156863</span>,  <span class="fl">0.8117647058823529</span>  ),  <span class="co"># 17becf</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.6196078431372549</span>,  <span class="fl">0.8549019607843137</span>,  <span class="fl">0.8980392156862745</span>),    <span class="co"># 9edae5</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div id="cell-fig-timeline" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.dates <span class="im">import</span> date2num, num2date</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> <span class="st">"Helvetica"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">"sans-serif"</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'ytick.labelleft'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'ytick.labelright'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> matplotlib.pyplot.figure(figsize<span class="op">=</span>(<span class="dv">24</span>,<span class="dv">12</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating axis</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add_axes([xmin,ymin,dx,dy])</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>ax_min <span class="op">=</span> fig.add_axes([<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>])</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>ax_min.axis(<span class="st">'off'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>ax_max <span class="op">=</span> fig.add_axes([<span class="fl">0.99</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>])</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ax_max.axis(<span class="st">'off'</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>ax_timeline <span class="op">=</span> fig.add_axes([<span class="fl">0.04</span>, <span class="fl">0.1</span>, <span class="fl">0.92</span>, <span class="fl">0.85</span>])</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ax_timeline.spines[<span class="st">"top"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax_timeline.spines[<span class="st">"right"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>ax_timeline.spines[<span class="st">"left"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>ax_timeline.grid(axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>ax_timeline.axvline(x<span class="op">=</span>dt.datetime(<span class="dv">2021</span>, <span class="dv">9</span>, <span class="dv">19</span>, <span class="dv">14</span>, <span class="dv">13</span>), ymin<span class="op">=</span><span class="fl">0.075</span>, ymax<span class="op">=</span><span class="fl">0.98</span>, color<span class="op">=</span><span class="st">'r'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_scatter(df, c, alpha<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>np.exp2(<span class="fl">1.3</span><span class="op">*</span>df[<span class="st">'Magnitude'</span>])</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax_timeline.scatter(df[<span class="st">'DateTime'</span>], df[<span class="st">'Depth(km)'</span>], s<span class="op">=</span>M, c<span class="op">=</span>c, alpha<span class="op">=</span>alpha, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, zorder<span class="op">=</span><span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># make_scatter(df_erupt, c=tab20c_colors[-1])</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>points_1 <span class="op">=</span> make_scatter(df_erupt_1, c<span class="op">=</span>[tab20_colors[<span class="dv">12</span>]], alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>points_2 <span class="op">=</span> make_scatter(df_erupt_2, c<span class="op">=</span>[tab20_colors[<span class="dv">16</span>]], alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>points_3 <span class="op">=</span> make_scatter(df_erupt_3, c<span class="op">=</span>[tab20_colors[<span class="dv">4</span>]], alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>points_4 <span class="op">=</span> make_scatter(df_erupt_4, c<span class="op">=</span>[tab20_colors[<span class="dv">2</span>]], alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>points_5 <span class="op">=</span> make_scatter(df_erupt_5, c<span class="op">=</span>[tab20_colors[<span class="dv">6</span>]], alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>ax_timeline.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelrotation<span class="op">=</span><span class="dv">0</span>, bottom<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_ylabel(<span class="st">''</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>ax_timeline.yaxis.set_ticks_position(<span class="st">'both'</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>ax_timeline.yaxis.set_ticks_position(<span class="st">'both'</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>xticks <span class="op">=</span> ax_timeline.get_xticks()</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>new_xticks <span class="op">=</span> [date2num(pd.to_datetime(<span class="st">'2021-09-11'</span>)),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    date2num(pd.to_datetime(<span class="st">'2021-09-19 14:13:00'</span>))]</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>new_xticks <span class="op">=</span> np.append(new_xticks, xticks[<span class="dv">2</span>:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_xticks(new_xticks)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>ax_timeline.invert_yaxis()</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>ax_timeline.spines[<span class="st">'bottom'</span>].set_position((<span class="st">'data'</span>, <span class="dv">45</span>))</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>ax_timeline.margins(tight<span class="op">=</span><span class="va">True</span>, x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>ax_timeline.legend(</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    [points_1, points_2, points_3, points_4, points_5],</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'0 &lt; M &lt;= 1'</span>,<span class="st">'1 &lt; M &lt;= 2'</span>,<span class="st">'2 &lt; M &lt;= 3'</span>,<span class="st">'3 &lt; M &lt;= 4'</span>,<span class="st">'M &gt; 4'</span>],</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    loc<span class="op">=</span><span class="st">'lower left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>), fancybox<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    borderpad<span class="op">=</span><span class="fl">1.0</span>, labelspacing<span class="op">=</span><span class="dv">1</span>, mode<span class="op">=</span><span class="st">"expand"</span>, title<span class="op">=</span><span class="st">"Event Magnitude (M)"</span>,</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    fontsize<span class="op">=</span><span class="dv">14</span>, title_fontsize<span class="op">=</span><span class="dv">14</span>, framealpha<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_ylim(ax_timeline.get_ylim()[<span class="dv">0</span>], <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'ERUPTION'</span>, (<span class="fl">0.055</span>, <span class="fl">0.42</span>), rotation<span class="op">=</span><span class="dv">90</span>, xycoords<span class="op">=</span><span class="st">'axes fraction'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Pre</span><span class="ch">\n</span><span class="st">Eruptive</span><span class="ch">\n</span><span class="st">Swarm'</span>, (<span class="fl">0.035</span>, <span class="fl">0.88</span>), rotation<span class="op">=</span><span class="dv">0</span>, xycoords<span class="op">=</span><span class="st">'axes fraction'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'b'</span>, horizontalalignment<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Early Eruptive</span><span class="ch">\n</span><span class="st">Phase'</span>, (<span class="fl">0.12</span>, <span class="fl">0.9</span>), rotation<span class="op">=</span><span class="dv">0</span>, xycoords<span class="op">=</span><span class="st">'axes fraction'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'orange'</span>, horizontalalignment<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Main Eruptive Phase</span><span class="ch">\n</span><span class="st">(sustained gas and lava ejection)'</span>, (<span class="fl">0.45</span>, <span class="fl">0.9</span>), rotation<span class="op">=</span><span class="dv">0</span>, xycoords<span class="op">=</span><span class="st">'axes fraction'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'green'</span>, horizontalalignment<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Final Eruptive Phase</span><span class="ch">\n</span><span class="st">(reducing gas and lava ejection)'</span>, (<span class="fl">0.86</span>, <span class="fl">0.9</span>), rotation<span class="op">=</span><span class="dv">0</span>, xycoords<span class="op">=</span><span class="st">'axes fraction'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'r'</span>, horizontalalignment<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime(<span class="st">'2021-09-11'</span>)), <span class="op">-</span><span class="dv">8</span>), date2num(pd.to_datetime(<span class="st">'2021-09-19 14:13:00'</span>))<span class="op">-</span>date2num(pd.to_datetime(<span class="st">'2021-09-11'</span>)), <span class="dv">53</span>, color<span class="op">=</span>tab20_colors[<span class="dv">0</span>], zorder<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime(<span class="st">'2021-09-19 14:13:00'</span>)), <span class="op">-</span><span class="dv">8</span>), date2num(pd.to_datetime(<span class="st">'2021-10-01'</span>))<span class="op">-</span>date2num(pd.to_datetime(<span class="st">'2021-09-19 14:13:00'</span>)), <span class="dv">53</span>, color<span class="op">=</span>tab20_colors[<span class="dv">2</span>], zorder<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime(<span class="st">'2021-10-01'</span>)), <span class="op">-</span><span class="dv">8</span>), date2num(pd.to_datetime(<span class="st">'2021-12-01'</span>))<span class="op">-</span>date2num(pd.to_datetime(<span class="st">'2021-10-01'</span>)), <span class="dv">53</span>, color<span class="op">=</span>tab20_colors[<span class="dv">4</span>], zorder<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime(<span class="st">'2021-12-01'</span>)), <span class="op">-</span><span class="dv">8</span>), date2num(pd.to_datetime(<span class="st">'2021-12-31'</span>))<span class="op">-</span>date2num(pd.to_datetime(<span class="st">'2021-12-01'</span>))<span class="op">+</span><span class="dv">1</span>, <span class="dv">53</span>, color<span class="op">=</span>tab20_colors[<span class="dv">6</span>], zorder<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>))<span class="op">;</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_title(<span class="st">"Recorded seismicity during the La Palma eruption 11 September - 15 December 2021 (INVOLCAN Dataset)"</span>, <span class="bu">dict</span>(fontsize<span class="op">=</span><span class="dv">24</span>), pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_ylabel(<span class="st">"Depth (km)"</span>, <span class="bu">dict</span>(fontsize<span class="op">=</span><span class="dv">20</span>), labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>ax_timeline.set_xlabel(<span class="st">"Eruption Timeline"</span>, <span class="bu">dict</span>(fontsize<span class="op">=</span><span class="dv">20</span>), labelpad<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-timeline" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p class=""><img src="article_files/figure-html/fig-timeline-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Earthquake data over time (n=5465) to understand their distributions spatially, by depth, by magnitude and in time.</figcaption>
</figure>
</div>
</div>
</div></div>
<div id="6014701a" class="cell markdown">
<section id="cumulative-distribution-plots" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-distribution-plots">Cumulative Distribution Plots</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="d0ea08d9" class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cumulative_events_mag_depth(df, hue<span class="op">=</span><span class="st">'Depth'</span>, kind<span class="op">=</span><span class="st">'scatter'</span>, ax<span class="op">=</span><span class="va">None</span>, dpi<span class="op">=</span><span class="dv">100</span>, palette<span class="op">=</span><span class="va">None</span>, kde<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    matplotlib.rcParams[<span class="st">'ytick.labelright'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> sns.jointplot(x<span class="op">=</span><span class="st">"Magnitude"</span>, y<span class="op">=</span><span class="st">"Depth(km)"</span>, data<span class="op">=</span>df,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                      kind<span class="op">=</span>kind, hue<span class="op">=</span>hue, height<span class="op">=</span><span class="dv">10</span>, space<span class="op">=</span><span class="fl">0.1</span>, marginal_ticks<span class="op">=</span><span class="va">False</span>, ratio<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                      hue_order<span class="op">=</span>[<span class="st">'Shallow (&lt;18km)'</span>, <span class="st">'Interchange (18km&gt;x&gt;28km)'</span>, <span class="st">'Deep (&gt;28km)'</span>],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                      ax<span class="op">=</span>ax, palette<span class="op">=</span>palette, ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">50</span>), xlim<span class="op">=</span>(<span class="fl">0.3</span>,<span class="fl">5.6</span>), edgecolor<span class="op">=</span><span class="st">".2"</span>, marginal_kws<span class="op">=</span><span class="bu">dict</span>(bins<span class="op">=</span><span class="dv">20</span>, hist_kws<span class="op">=</span>{<span class="st">'edgecolor'</span>: <span class="st">'black'</span>}))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> kde:</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        g.plot_joint(sns.kdeplot, color<span class="op">=</span><span class="st">"b"</span>, zorder<span class="op">=</span><span class="dv">1</span>, levels<span class="op">=</span><span class="dv">15</span>, ax<span class="op">=</span>ax)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    g.fig.axes[<span class="dv">0</span>].invert_yaxis()<span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    g.fig.set_dpi(dpi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div id="cell-fig-cumulative" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> warnings.catch_warnings():</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    warnings.simplefilter(<span class="st">"ignore"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    cumulative_events_mag_depth(df_ign, hue<span class="op">=</span><span class="va">None</span>, dpi<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(<span class="st">'Cumulative Events 01-01-2017 to 01-01-2022'</span>, y<span class="op">=</span><span class="fl">1.01</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-cumulative" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p class=""><img src="article_files/figure-html/fig-cumulative-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Cumulative earthquake data over time (n=5465) to understand their distributions spatially, by depth and magnitude.</figcaption>
</figure>
</div>
</div>
</div></div>
<div id="a8eb85c8" class="cell markdown">
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>The dataset was loaded into this Jupyter notebook and filtered down to La Palma events only. This results in 5465 data points which we then visualized to understand their distributions spatially, by depth, by magnitude and in time.</p>
<p>From our analysis above, we can see 3 different systems in play.</p>
<p>Firstly, the shallow earthquake swarm leading up to the eruption on 19th September, related to significant surface deformation and shallow magma intrusion.</p>
<p>After the eruption, continuous shallow seismicity started at 10-15km corresponding to magma movement in the crustal reservoir.</p>
<p>Subsequently, high magnitude events begin occurring at 30-40km depths corresponding to changes in the mantle reservoir. These are also continuous but occur with a lower frequency than in the crustal reservoir.</p>
</section>
</div>
<div id="f0774682" class="cell markdown">
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>From the analysis of the earthquake data collected and published by IGN for the period of 11 September through to 9 November 2021. Visualization of the earthquake events at different depths appears to confirm the presence of both mantle and crustal reservoirs as proposed by <span class="citation" data-cites="marrero2019">Marrero et al. (<a href="#ref-marrero2019" role="doc-biblioref">2019</a>)</span>.</p>
</section>
</div>
<div id="e445a1b1" class="cell markdown">
<section id="availability" class="level2">
<h2 class="anchored" data-anchor-id="availability">Availability</h2>
<p>A web scraping script was developed to pull data into a machine-readable form for analysis. That code tool <a href="https://github.com/stevejpurves/ign-earthquake-data">is available on GitHub</a> along with a copy of recently updated data.</p>
</section>
</div>
<div id="77ec87f2" class="cell markdown">

</div>
<div id="48306e99" class="cell markdown">

</div>
<div id="411eb897-43aa-4fe6-b9df-ed24ef2581c3" class="cell markdown">
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
</section>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-marrero2019" class="csl-entry" role="listitem">
Marrero, José, Alicia García, Manuel Berrocoso, Ángeles Llinares, Antonio Rodríguez-Losada, and R. Ortiz. 2019. <span>“Strategies for the Development of Volcanic Hazard Maps in Monogenetic Volcanic Fields: The Example of <span>La</span> <span>Palma</span> (<span>Canary</span> <span>Islands</span>).”</span> <em>Journal of Applied Volcanology</em> 8 (July). <a href="https://doi.org/10.1186/s13617-019-0085-5">https://doi.org/10.1186/s13617-019-0085-5</a>.
</div>
</div>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>